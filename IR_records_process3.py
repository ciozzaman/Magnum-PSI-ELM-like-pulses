import numpy as np
exec(open("/home/ffederic/work/analysis_scripts/scripts/preamble_import_pc.py").read())
# import matplotlib.pyplot as plt
#import .functions
os.chdir('/home/ffederic/work/Collaboratory/test/experimental_data')
from functions.spectools import rotate,do_tilt, binData, get_angle, get_tilt,get_angle_2
from functions.Calibrate import do_waveL_Calib, do_Intensity_Calib
from functions.fabio_add import find_nearest_index,multi_gaussian,all_file_names,load_dark,find_index_of_file,get_metadata,movie_from_data,get_angle_no_lines,do_tilt_no_lines,four_point_transform,fix_minimum_signal,fix_minimum_signal2,get_bin_and_interv_no_lines,examine_current_trace
from functions.GetSpectrumGeometry import getGeom
from functions.SpectralFit import doSpecFit_single_frame
from functions.GaussFitData import doLateralfit_time_tependent
import collections

import os,sys
from PIL import Image
import xarray as xr
import pandas as pd
import copy
from uncertainties.unumpy import exp,nominal_values,std_devs,erf
from uncertainties import ufloat,unumpy,correlated_values
from scipy.optimize import curve_fit
from scipy import interpolate
from scipy.signal import find_peaks, peak_prominences as get_proms
from multiprocessing import Pool,cpu_count
number_cpu_available = cpu_count()
print('Number of cores available: '+str(number_cpu_available))


os.chdir('/home/ffederic/work/Collaboratory/test/experimental_data/functions')
print(os.path.abspath(os.getcwd()))
import pyradi.ryptw as ryptw

fdir = '/home/ffederic/work/Collaboratory/test/experimental_data'
df_log = pd.read_csv('/home/ffederic/work/Collaboratory/test/experimental_data/functions/Log/shots_3.csv',index_col=0)
df_settings = pd.read_csv('/home/ffederic/work/Collaboratory/test/experimental_data/functions/Log/settings_3.csv',index_col=0)
figure_index=0


def exponential_decay(time,*args):
	out = args[1]*np.exp(-(time-args[3])/args[2]) + args[0]
	return out

def semi_infinite_sink_full_decrease(time,*args):
	out = (args[1]/(args[2]))*2/((np.pi*thermal_conductivity*heat_capacity*density)**0.5) *((time-args[3])**0.5 - (time-args[3]-args[2])**0.5) + args[0]
	# print(out)
	return out

def gaussian_1D_fitting(spatial_coord,*args):
	out = args[1]*np.exp(- (spatial_coord**2)/(2*(args[2]**2)) ) + args[0]
	return out

# simulated strong pulses
# heat_flux = 8e8e^(-(r^2)/(2*(0.005^2)))*(0.0917*0.1+0.5*0.7*e^(-((t-0.00033-1)^2)/(2*(0.000144^2)))+0.5*0.208*e^(-((t-0.000457-1)^2)/(2*(0.000218^2))))

guess=[650.,1,1e-3,1.]
a=np.array([1.00121,1.00125,1.00128,1.00132,1.00137,1.00142,1.00147,1.00153,1.00159,1.00165,1.00171,1.00179,1.00186,1.00195,1.00206,1.00216,1.00228,1.00242,1.00255,1.00271,1.0029,1.00308,1.0033,1.00356,1.00387,1.00417,1.00453,1.00496,1.00547,1.00607,1.00667,1.00727,1.00787,1.00847,1.00907,1.00967,1.01027,1.01087,1.01147,1.01207,1.01267,1.01327,1.01387,1.01447,1.01507,1.01567,1.01627,1.01687,1.01747,1.01807,1.01867,1.01927,1.01987,1.02047,1.02107,1.02167,1.02227,1.02287,1.02347,1.02407,1.02467,1.02527,1.02587,1.02647,1.02707,1.02767,1.02827,1.02887,1.02947,1.03])
b=np.array([1359.85,1341.76,1325.53,1307.45,1287.51,1271.15,1252.98,1233,1216.62,1198.51,1183.98,1165.33,1149.03,1131.1,1111.57,1095.19,1077.3,1057.96,1041.58,1023.82,1004.8,988.426,970.867,952.252,932.752,916.31,899.039,881.122,862.776,844.675,829.177,815.765,804.05,793.735,784.588,776.428,769.107,762.508,756.533,751.102,746.148,741.614,737.453,733.623,730.089,726.822,723.794,720.982,718.367,715.929,713.654,711.526,709.534,707.667,705.913,704.265,702.713,701.251,699.871,698.568,697.335,696.169,695.063,694.014,693.018,692.072,691.171,690.314,689.496,688.804])
bds = [[20,1e-3,1e-4,1],[np.inf,np.inf,1e-3,1.0005]]
fit = curve_fit(semi_infinite_sink_full_decrease, a[a>=1.0015+0.00046], b[a>=1.0015+0.00046], guess,bounds=bds,maxfev=int(1e4))#,xtol=1e-15,ftol=1e-12)
fit_wit_errors = correlated_values(fit[0],fit[1])
fit_wit_errors[1]*2*np.pi*(0.005**2)
guess = [1000,1e8,1e-3,1]
bds=[[20,0,0,1],[np.inf,np.inf,np.inf,np.inf]]
fit = curve_fit(exponential_decay, a[a>=1.0015], b[a>=1.0015], guess,bounds=bds,maxfev=int(1e4))#,xtol=1e-15,ftol=1e-12)

c=np.array([0,9.07572E-06,2.07208E-05,3.38475E-05,4.74074E-05,6.10294E-05,7.47899E-05,8.87175E-05,0.000102839,0.000117459,0.000132012,0.000146336,0.000160487,0.000174555,0.000188591,0.000202616,0.000216638,0.000230657,0.000244676,0.000258627,0.000272643,0.000286584,0.000300475,0.000314378,0.000328406,0.000342433,0.000356384,0.00037041,0.000384433,0.000398456,0.000412477,0.000426497,0.000440523,0.000454553,0.000468577,0.000482596,0.000496612,0.000510626,0.000524639,0.000538651,0.000552663,0.000566674,0.00058069,0.000594702,0.000608713,0.000622723,0.000636732,0.00065074,0.000664749,0.000678756,0.000692764,0.000706771,0.000720778,0.000734785,0.000748792,0.000762798,0.000776804,0.000790776,0.000804782,0.000818788,0.000832794,0.0008468,0.000860805,0.00087481,0.000888816,0.00090282,0.000916825,0.00093083,0.000944834,0.000958839,0.000972843,0.000986847,0.00100085,0.00101486,0.00102886,0.00104286,0.00105687,0.00107087,0.00108487,0.00109888,0.00111288,0.00112688,0.00114089,0.00115489,0.00116889,0.00118289,0.0011969,0.0012109,0.0012249,0.00123891,0.00125291,0.00126691,0.00128091,0.00129492,0.00130892,0.00132292,0.00133692,0.00135092,0.00136493,0.00137893,0.00139293,0.00140693,0.00142093,0.00143494,0.00144894,0.00146294,0.00147694,0.00149094,0.00150494,0.00151895,0.00153295,0.00154695,0.00156095,0.00157495,0.00158895,0.00160296,0.00161696,0.00163096,0.00164496,0.00165896,0.00167296,0.00168696,0.00170097,0.00171497,0.00172897,0.00174297,0.00175697,0.00177097,0.00178497,0.00179897,0.00181297,0.00182698,0.00184098,0.00185498,0.00186898,0.00188298,0.00189698,0.00191098,0.00192498,0.00193898,0.00195298,0.00196699,0.00198099,0.00199499,0.00200899,0.00202299,0.00203699,0.00205099,0.00206499,0.00207899,0.00209299,0.00210699,0.00212099,0.002135,0.002149,0.002163,0.002177,0.002191,0.002205,0.002219,0.002233,0.002247,0.002261,0.002275,0.002289,0.002303,0.002317,0.002331,0.002345,0.00235901,0.00237301,0.00238701,0.00240101,0.00241501,0.00242901,0.00244301,0.00245701,0.00247101,0.00248501,0.00249901,0.00251301,0.00252701,0.00254101,0.00255501,0.00256901,0.00258301,0.00259701,0.00261101,0.00262501,0.00263901,0.00265301,0.00266701,0.00268102,0.00269502,0.00270902,0.00272302,0.00273702,0.00275102,0.00276502,0.00277902,0.00279302,0.00280702,0.00282102,0.00283502,0.00284902,0.00286302,0.00287702,0.00289102,0.00290502,0.00291902,0.00293302,0.00294702,0.00296102,0.00297502,0.00298902,0.00300302,0.00301702,0.00303102,0.00304502,0.00305902,0.00307302,0.00308702,0.00310102,0.00311502,0.00312902,0.00314302,0.00315702,0.00317102,0.00318502,0.00319902,0.00321302,0.00322702,0.00324102,0.00325502,0.00326902,0.00328302,0.00329702,0.00331102,0.00332502,0.00333902,0.00335303,0.00336703,0.00338103,0.00339503,0.00340903,0.00342303,0.00343703,0.00345103,0.00346503,0.00347903,0.00349303,0.00350703,0.00352103,0.00353503,0.00354903,0.00356303,0.00357703,0.00359103,0.00360503,0.00361903,0.00363303,0.00364703,0.00366103,0.00367503,0.00368903,0.00370303,0.00371703,0.00373103,0.00374503,0.00375902,0.00377302,0.00378702,0.00380102,0.00381502,0.00382902,0.00384302,0.00385702,0.00387102,0.00388502,0.00389902,0.00391302,0.00392702,0.00394102,0.00395502,0.00396902,0.00398302,0.00399702,0.00401102,0.00402502,0.00403902,0.00405302,0.00406702,0.00408102,0.00409502,0.00410902,0.00412302,0.00413702,0.00415102,0.00416502,0.00417902,0.00419302,0.00420702,0.00422102,0.00423502,0.00424902,0.00426302,0.00427702,0.00429102,0.00430502,0.00431902,0.00433302,0.00434702,0.00436102,0.00437502,0.00438902,0.00440302,0.00441702,0.00443102,0.00444501,0.00445901,0.00447301,0.00448701,0.00450101,0.00451501,0.00452901,0.00454301,0.00455701,0.00457101,0.00458501,0.00459901,0.00461301,0.00462701,0.00464101,0.00465501,0.00466901,0.00468301,0.00469701,0.00471101,0.00472501,0.00473901,0.004753,0.004767,0.004781,0.004795,0.004809,0.004823,0.004837,0.004851,0.004865,0.004879,0.004893,0.004907,0.004921,0.004935,0.004949,0.004963,0.00497699,0.00499099,0.00500499,0.00501899,0.00503299,0.00504699,0.00506099,0.00507499,0.00508899,0.00510299,0.00511699,0.00513099,0.00514498,0.00515898,0.00517298,0.00518698,0.00520098,0.00521498,0.00522898,0.00524298,0.00525698,0.00527098,0.00528497,0.00529897,0.00531297,0.00532697,0.00534097,0.00535497,0.00536897,0.00538297,0.00539697,0.00541096,0.00542496,0.00543896,0.00545296,0.00546696,0.00548096,0.00549496,0.00550895,0.00552295,0.00553695,0.00555095,0.00556495,0.00557895,0.00559295,0.00560694,0.00562094,0.00563494,0.00564894,0.00566294,0.00567693,0.00569093,0.00570493,0.00571893,0.00573293,0.00574692,0.00576092,0.00577492,0.00578892,0.00580292,0.00581691,0.00583091,0.00584491,0.00585891,0.0058729,0.0058869,0.0059009,0.0059149,0.00592889,0.00594289,0.00595689,0.00597088,0.00598488,0.00599888,0.00601287,0.00602687,0.00604087,0.00605486,0.00606886,0.00608286,0.00609685,0.00611085,0.00612484,0.00613884,0.00615284,0.00616683,0.00618083,0.00619482,0.00620882,0.00622281,0.00623681,0.0062508,0.0062648,0.00627879,0.00629278,0.00630681,0.00632081,0.0063348,0.0063488,0.00636279,0.00637678,0.00639078,0.00640477,0.00641876,0.00643275,0.00644675,0.00646074,0.00647473,0.00648872,0.00650271,0.0065167,0.00653069,0.00654468,0.00655867,0.00657266,0.00658665,0.00660063,0.00661462,0.00662861,0.00664259,0.00665658,0.00667056,0.00668454,0.00669852,0.0067125,0.00672647,0.00674045,0.00675443,0.00676841,0.00678238,0.00679635,0.00681039,0.00682437,0.00683857,0.00685264,0.00686667,0.00688061,0.00689445,0.00690827,0.00692205,0.00693588,0.00694979,0.00696489,0.00698097,0.00699277,0.00700172,0.00701228,0.00702724,0.00705401,0.00708569,0.00712019,0.00715642,0.00719363,0.00723093,0.00726832,0.0073067,0.00734276,0.00737863,0.00741422,0.00744984,0.00748516,0.00752032,0.00755532,0.00759005,0.00762498,0.0076596,0.00769426,0.00772734,0.00776107,0.00779501,0.00782919,0.00786338,0.00789767,0.00793234,0.00796723,0.00800232,0.00803745,0.00807219,0.00810647,0.0081404,0.00817508,0.00821077,0.00824671,0.0082824,0.00831749,0.00835223,0.00838744,0.0084234,0.00845936,0.00849465,0.00852881,0.00856207,0.00859524,0.00862923,0.0086641,0.00869948,0.00873486,0.00876983,0.00880355,0.00883676,0.00887259,0.00891012,0.00894674,0.00898227,0.0090162,0.00904953,0.00908495,0.00912142,0.00915691,0.00919153,0.00922485,0.0092578,0.00929326,0.00933019,0.00936581,0.00939964,0.00943263,0.00946788,0.00950454,0.00953998,0.00957381,0.00960698,0.00964272,0.00968002,0.00971597,0.0097501,0.00978355,0.0098193,0.00985626,0.00989181,0.00992559,0.00995873,0.00999419,0.010031,0.0100665,0.0101002,0.0101333,0.0101688,0.0102056,0.0102412,0.0102749,0.0103078,0.010343,0.0103797,0.0104154,0.0104494,0.010483,0.0105192,0.0105571,0.0105935,0.0106281,0.010662,0.010698,0.0107346,0.0107695,0.0108025,0.0108349,0.0108696,0.010906,0.0109414,0.0109755,0.0110091,0.0110452,0.0110828,0.0111188,0.0111531,0.0111869,0.0112229,0.0112597,0.0112948,0.0113281,0.0113608,0.0113959,0.0114323,0.0114675,0.0115014,0.0115348,0.0115708,0.0116083,0.0116444,0.0116787,0.0117125,0.0117484,0.0117851,0.01182,0.0118531,0.0118857,0.0119207,0.0119572,0.0119927,0.0120268,0.0120604,0.0120966,0.012134,0.01217,0.0122042,0.0122379,0.0122738,0.0123106,0.0123458,0.0123791,0.012412,0.0124472,0.0124836,0.0125188,0.0125525,0.0125859,0.0126219,0.0126593,0.0126954,0.0127296,0.0127635,0.0127998,0.0128369,0.0128725,0.012906,0.0129392,0.0129745,0.013011,0.0130464,0.0130802,0.0131137,0.0131493,0.0131858,0.013221,0.0132546,0.0132879,0.0133235,0.0133605,0.0133967,0.0134321,0.0134663,0.0135005,0.0135372,0.0135743,0.0136094,0.0136435,0.0136769,0.0137091,0.0137404,0.0137736,0.0138092,0.0138456,0.013881,0.0139158,0.0139508])
# profile at t=+0.002s
d=np.array([1183.98,1184.02,1183.95,1183.88,1183.85,1183.81,1183.76,1183.7,1183.63,1183.57,1183.53,1183.49,1183.45,1183.4,1183.33,1183.27,1183.19,1183.11,1183.03,1182.94,1182.85,1182.75,1182.64,1182.54,1182.42,1182.3,1182.18,1182.05,1181.91,1181.77,1181.63,1181.47,1181.32,1181.16,1180.99,1180.82,1180.64,1180.46,1180.28,1180.08,1179.89,1179.69,1179.48,1179.27,1179.05,1178.83,1178.6,1178.37,1178.14,1177.89,1177.65,1177.4,1177.14,1176.88,1176.61,1176.34,1176.06,1175.78,1175.5,1175.21,1174.91,1174.61,1174.3,1173.99,1173.68,1173.36,1173.03,1172.7,1172.37,1172.03,1171.68,1171.33,1170.98,1170.62,1170.26,1169.89,1169.51,1169.13,1168.75,1168.36,1167.97,1167.57,1167.17,1166.76,1166.35,1165.93,1165.51,1165.09,1164.66,1164.22,1163.78,1163.34,1162.89,1162.43,1161.97,1161.51,1161.04,1160.57,1160.09,1159.61,1159.13,1158.63,1158.14,1157.64,1157.13,1156.62,1156.11,1155.59,1155.07,1154.54,1154.01,1153.47,1152.93,1152.39,1151.84,1151.29,1150.73,1150.16,1149.6,1149.02,1148.45,1147.87,1147.28,1146.69,1146.1,1145.5,1144.9,1144.29,1143.68,1143.07,1142.45,1141.83,1141.2,1140.57,1139.93,1139.29,1138.65,1138,1137.34,1136.69,1136.03,1135.36,1134.69,1134.02,1133.34,1132.66,1131.97,1131.28,1130.59,1129.89,1129.19,1128.48,1127.77,1127.06,1126.34,1125.62,1124.9,1124.17,1123.43,1122.7,1121.96,1121.21,1120.46,1119.71,1118.95,1118.19,1117.43,1116.66,1115.89,1115.11,1114.34,1113.55,1112.77,1111.98,1111.18,1110.39,1109.58,1108.78,1107.97,1107.16,1106.35,1105.53,1104.7,1103.88,1103.05,1102.22,1101.38,1100.54,1099.7,1098.85,1098,1097.15,1096.29,1095.43,1094.57,1093.7,1092.83,1091.96,1091.08,1090.2,1089.32,1088.43,1087.54,1086.65,1085.75,1084.85,1083.95,1083.04,1082.14,1081.22,1080.31,1079.39,1078.47,1077.55,1076.62,1075.69,1074.76,1073.82,1072.88,1071.94,1070.99,1070.05,1069.1,1068.14,1067.19,1066.23,1065.27,1064.3,1063.33,1062.36,1061.39,1060.42,1059.44,1058.46,1057.47,1056.49,1055.5,1054.51,1053.51,1052.52,1051.52,1050.52,1049.51,1048.5,1047.49,1046.48,1045.47,1044.45,1043.43,1042.41,1041.39,1040.36,1039.33,1038.3,1037.27,1036.23,1035.2,1034.16,1033.11,1032.07,1031.02,1029.97,1028.92,1027.87,1026.81,1025.76,1024.7,1023.64,1022.57,1021.51,1020.44,1019.37,1018.3,1017.22,1016.15,1015.07,1013.99,1012.91,1011.83,1010.74,1009.65,1008.57,1007.48,1006.38,1005.29,1004.19,1003.1,1002,1000.9,999.793,998.689,997.583,996.476,995.367,994.256,993.144,992.03,990.915,989.798,988.68,987.56,986.439,985.316,984.192,983.067,981.94,980.812,979.682,978.552,977.42,976.286,975.151,974.016,972.878,971.74,970.6,969.46,968.318,967.175,966.03,964.885,963.739,962.591,961.443,960.293,959.143,957.991,956.838,955.685,954.53,953.375,952.219,951.062,949.904,948.745,947.585,946.424,945.263,944.101,942.938,941.774,940.61,939.444,938.279,937.112,935.945,934.777,933.609,932.44,931.27,930.1,928.929,927.757,926.586,925.413,924.24,923.067,921.893,920.719,919.544,918.369,917.194,916.018,914.842,913.665,912.488,911.311,910.134,908.956,907.778,906.6,905.421,904.243,903.064,901.885,900.706,899.526,898.347,897.167,895.988,894.808,893.628,892.448,891.269,890.089,888.909,887.729,886.549,885.37,884.19,883.011,881.831,880.652,879.473,878.294,877.115,875.936,874.758,873.579,872.401,871.224,870.046,868.869,867.692,866.515,865.339,864.163,862.987,861.812,860.637,859.463,858.288,857.115,855.942,854.769,853.596,852.425,851.253,850.083,848.912,847.743,846.573,845.405,844.237,843.069,841.903,840.736,839.571,838.406,837.242,836.078,834.916,833.754,832.592,831.432,830.272,829.113,827.954,826.797,825.64,824.484,823.329,822.175,821.022,819.869,818.718,817.567,816.417,815.269,814.121,812.974,811.825,810.68,809.536,808.393,807.251,806.11,804.97,803.831,802.693,801.557,800.421,799.287,798.153,797.021,795.89,794.76,793.632,792.504,791.378,790.253,789.129,788.006,786.885,785.765,784.646,783.529,782.413,781.298,780.185,779.073,777.962,776.853,775.745,774.638,773.534,772.43,771.323,770.221,769.104,767.998,766.899,765.809,764.727,763.648,762.573,761.493,760.398,759.189,758.003,757.05,756.328,755.474,754.49,752.445,749.983,747.318,744.537,741.702,738.878,736.062,733.186,730.514,727.866,725.253,722.644,720.072,717.52,714.991,712.489,709.978,707.501,705.034,702.662,700.265,697.867,695.466,693.074,690.686,688.285,685.88,683.477,681.09,678.741,676.435,674.154,671.831,669.46,667.092,664.765,662.491,660.247,657.98,655.686,653.418,651.216,649.096,647.04,644.984,642.883,640.743,638.593,636.459,634.373,632.373,630.386,628.259,626.075,623.97,621.949,620.034,618.134,616.131,614.112,612.163,610.279,608.472,606.674,604.753,602.792,600.923,599.16,597.428,595.592,593.72,591.931,590.234,588.559,586.772,584.945,583.208,581.573,579.96,578.252,576.524,574.882,573.331,571.803,570.181,568.531,566.958,565.474,564.014,562.466,560.889,559.387,557.972,556.589,555.122,553.62,552.182,550.82,549.476,548.04,546.574,545.186,543.887,542.606,541.263,539.927,538.67,537.491,536.329,535.094,533.827,532.608,531.451,530.312,529.102,527.873,526.712,525.622,524.548,523.419,522.293,521.236,520.244,519.268,518.234,517.185,516.183,515.236,514.303,513.312,512.306,511.356,510.467,509.594,508.681,507.773,506.923,506.127,505.347,504.522,503.681,502.88,502.125,501.384,500.602,499.815,499.077,498.389,497.715,497.01,496.312,495.661,495.055,494.46,493.837,493.213,492.623,492.07,491.53,490.961,490.39,489.858,489.364,488.883,488.382,487.891,487.438,487.021,486.616,486.196,485.784,485.398,485.042,484.697,484.344,484.001,483.686,483.397,483.117,482.832,482.555,482.299,482.063,481.849,481.643,481.437,481.25,481.087,480.941,480.81,480.696,480.592,480.492,480.399,480.321,480.261,480.27,480.234])
# profile at t=+0.010s
d1=np.array([776.428,776.469,776.395,776.337,776.32,776.287,776.25,776.211,776.171,776.138,776.125,776.12,776.109,776.093,776.072,776.048,776.022,775.994,775.964,775.933,775.899,775.864,775.827,775.789,775.748,775.704,775.659,775.612,775.562,775.51,775.457,775.401,775.344,775.285,775.224,775.161,775.096,775.029,774.96,774.89,774.817,774.742,774.666,774.588,774.508,774.426,774.342,774.256,774.169,774.079,773.988,773.895,773.8,773.703,773.604,773.503,773.401,773.298,773.192,773.084,772.974,772.863,772.749,772.634,772.517,772.398,772.277,772.154,772.03,771.904,771.776,771.646,771.514,771.381,771.245,771.108,770.97,770.829,770.686,770.542,770.396,770.248,770.099,769.947,769.794,769.639,769.483,769.324,769.164,769.002,768.838,768.673,768.505,768.336,768.166,767.993,767.819,767.643,767.465,767.286,767.105,766.922,766.737,766.551,766.363,766.173,765.982,765.788,765.593,765.397,765.198,764.998,764.797,764.593,764.388,764.182,763.973,763.763,763.551,763.338,763.123,762.906,762.688,762.468,762.246,762.023,761.798,761.571,761.343,761.113,760.882,760.648,760.414,760.177,759.939,759.7,759.459,759.216,758.972,758.726,758.478,758.229,757.978,757.726,757.472,757.217,756.96,756.702,756.442,756.18,755.917,755.652,755.386,755.118,754.849,754.578,754.306,754.032,753.757,753.48,753.202,752.922,752.641,752.358,752.074,751.788,751.501,751.212,750.922,750.631,750.338,750.043,749.747,749.45,749.151,748.851,748.549,748.246,747.942,747.636,747.329,747.02,746.71,746.399,746.086,745.772,745.456,745.139,744.821,744.501,744.18,743.858,743.535,743.21,742.883,742.556,742.227,741.896,741.565,741.232,740.898,740.562,740.226,739.887,739.548,739.208,738.866,738.523,738.178,737.833,737.486,737.138,736.788,736.438,736.086,735.733,735.379,735.023,734.667,734.309,733.95,733.59,733.229,732.866,732.502,732.138,731.772,731.404,731.036,730.667,730.296,729.925,729.552,729.178,728.803,728.427,728.05,727.671,727.292,726.912,726.53,726.147,725.764,725.379,724.993,724.607,724.219,723.83,723.44,723.049,722.657,722.264,721.87,721.475,721.08,720.683,720.285,719.886,719.486,719.085,718.684,718.281,717.877,717.473,717.067,716.661,716.254,715.846,715.436,715.026,714.615,714.204,713.791,713.378,712.963,712.548,712.132,711.715,711.297,710.878,710.459,710.038,709.617,709.195,708.773,708.349,707.925,707.5,707.074,706.647,706.22,705.792,705.363,704.933,704.502,704.071,703.639,703.207,702.773,702.339,701.904,701.469,701.033,700.596,700.158,699.72,699.281,698.842,698.401,697.961,697.519,697.077,696.634,696.191,695.747,695.302,694.857,694.411,693.965,693.518,693.07,692.622,692.173,691.724,691.274,690.824,690.373,689.921,689.469,689.017,688.564,688.11,687.656,687.201,686.746,686.291,685.835,685.378,684.921,684.464,684.006,683.548,683.089,682.63,682.17,681.71,681.249,680.788,680.327,679.865,679.403,678.941,678.478,678.014,677.551,677.087,676.622,676.158,675.693,675.227,674.761,674.295,673.829,673.362,672.895,672.428,671.96,671.492,671.024,670.556,670.087,669.618,669.149,668.679,668.209,667.739,667.269,666.799,666.328,665.857,665.386,664.914,664.443,663.971,663.499,663.027,662.555,662.082,661.61,661.137,660.664,660.191,659.718,659.244,658.771,658.297,657.823,657.35,656.876,656.402,655.927,655.453,654.979,654.504,654.03,653.555,653.081,652.606,652.131,651.656,651.182,650.707,650.232,649.757,649.282,648.807,648.332,647.857,647.383,646.908,646.433,645.958,645.483,645.008,644.534,644.059,643.584,643.11,642.635,642.161,641.686,641.212,640.738,640.264,639.79,639.316,638.842,638.368,637.894,637.421,636.948,636.474,636.001,635.528,635.056,634.583,634.111,633.638,633.166,632.694,632.222,631.749,631.278,630.807,630.336,629.865,629.394,628.924,628.454,627.984,627.514,627.044,626.575,626.106,625.638,625.169,624.701,624.233,623.765,623.298,622.831,622.364,621.898,621.432,620.966,620.5,620.035,619.57,619.106,618.641,618.178,617.714,617.251,616.788,616.326,615.864,615.402,614.939,614.477,614.009,613.546,613.086,612.63,612.177,611.725,611.273,610.819,610.351,609.818,609.346,608.894,608.555,608.157,607.799,606.946,605.891,604.751,603.565,602.36,601.16,599.965,598.743,597.616,596.496,595.391,594.286,593.196,592.112,591.036,589.969,588.893,587.831,586.772,585.736,584.696,583.653,582.61,581.569,580.528,579.48,578.428,577.378,576.337,575.311,574.301,573.296,572.268,571.22,570.176,569.154,568.156,567.165,566.159,565.145,564.146,563.179,562.247,561.339,560.422,559.479,558.519,557.557,556.603,555.672,554.779,553.873,552.903,551.922,550.981,550.077,549.222,548.356,547.444,546.537,545.66,544.814,543.998,543.173,542.289,541.399,540.553,539.754,538.956,538.107,537.253,536.438,535.663,534.886,534.055,533.218,532.424,531.677,530.927,530.133,529.339,528.586,527.873,527.16,526.401,525.637,524.911,524.224,523.539,522.811,522.079,521.382,520.725,520.073,519.379,518.677,518.006,517.369,516.732,516.051,515.365,514.719,514.113,513.508,512.874,512.251,511.664,511.111,510.559,509.97,509.372,508.797,508.251,507.707,507.129,506.55,506.003,505.49,504.978,504.44,503.909,503.412,502.945,502.478,501.983,501.486,501.012,500.563,500.115,499.64,499.162,498.713,498.293,497.875,497.438,497.009,496.607,496.23,495.856,495.459,495.058,494.677,494.318,493.962,493.585,493.211,492.861,492.535,492.211,491.872,491.541,491.233,490.945,490.659,490.359,490.061,489.779,489.515,489.254,488.978,488.705,488.451,488.216,487.983,487.74,487.505,487.289,487.091,486.894,486.69,486.492,486.307,486.136,485.967,485.796,485.63,485.479,485.339,485.202,485.061,484.926,484.801,484.687,484.582,484.48,484.378,484.287,484.207,484.135,484.071,484.015,483.962,483.91,483.861,483.821,483.789,483.81,483.791])
guess = [400,1000,0.005]
curve_fit(gaussian_1D_fitting,c,d,guess)
curve_fit(gaussian_1D_fitting,c,d1,guess)



# simulated weak pulses
# heat_flux = 2e8e^(-(r^2)/(2*(0.005^2)))*(0.0917*0.1+0.5*0.7*e^(-((t-0.00033-1)^2)/(2*(0.000144^2)))+0.5*0.208*e^(-((t-0.000457-1)^2)/(2*(0.000218^2))))

guess=[650.,1,1e-3,1.]
a=np.array([1.00131,1.00146,1.00164,1.00171,1.00193,1.00219,1.0025,1.00288,1.00334,1.00388,1.00448,1.00508,1.00568,1.00628,1.00688,1.00748,1.00808,1.00868,1.00928,1.00988,1.01048,1.01108,1.01168,1.01228,1.01288,1.01348,1.01408,1.01468,1.01528,1.01588,1.01648,1.01708,1.01768,1.01828,1.01888,1.01948,1.02008,1.02068,1.02128,1.02188,1.02248,1.02308,1.02368,1.02428,1.02488,1.02548,1.02608,1.02668,1.02728,1.02788,1.02848,1.02908,1.02968,1.03])
b=np.array([551.856,537.721,524.395,519.705,508.059,496.936,486.351,476.322,466.865,457.992,450.251,443.974,438.777,434.402,430.666,427.44,424.625,422.148,419.954,417.996,416.24,414.658,413.225,411.922,410.734,409.646,408.647,407.728,406.88,406.095,405.368,404.693,404.064,403.478,402.931,402.42,401.941,401.491,401.069,400.673,400.299,399.947,399.614,399.3,399.003,398.722,398.456,398.203,397.962,397.734,397.517,397.31,397.112,397.009])
bds = [[20,1e-3,1e-4,1],[np.inf,np.inf,1e-3,1.0005]]
# fit = curve_fit(semi_infinite_sink_full_decrease, a, b, guess,bounds=bds,maxfev=int(1e4),xtol=1e-15,ftol=1e-12)
fit = curve_fit(semi_infinite_sink_full_decrease, a[a>=1.0015+0.00046], b[a>=1.0015+0.00046], guess,bounds=bds,maxfev=int(1e4))#,xtol=1e-15,ftol=1e-12)
fit_wit_errors = correlated_values(fit[0],fit[1])
fit_wit_errors[1]*2*np.pi*(0.005**2)
guess = [1000,1e8,1e-3,1]
bds=[[20,0,0,1],[np.inf,np.inf,np.inf,np.inf]]
fit = curve_fit(exponential_decay, a, b, guess,bounds=bds,maxfev=int(1e4),xtol=1e-15,ftol=1e-12)
fit = curve_fit(exponential_decay, a[a>=1.0015], b[a>=1.0015], guess,bounds=bds,maxfev=int(1e4))#,xtol=1e-15,ftol=1e-12)

c=np.array([0,9.07572E-06,2.07208E-05,3.38475E-05,4.74074E-05,6.10294E-05,7.47899E-05,8.87175E-05,0.000102839,0.000117459,0.000132012,0.000146336,0.000160487,0.000174555,0.000188591,0.000202616,0.000216638,0.000230657,0.000244676,0.000258627,0.000272643,0.000286584,0.000300475,0.000314378,0.000328406,0.000342433,0.000356384,0.00037041,0.000384433,0.000398456,0.000412477,0.000426497,0.000440523,0.000454553,0.000468577,0.000482596,0.000496612,0.000510626,0.000524639,0.000538651,0.000552663,0.000566674,0.00058069,0.000594702,0.000608713,0.000622723,0.000636732,0.00065074,0.000664749,0.000678756,0.000692764,0.000706771,0.000720778,0.000734785,0.000748792,0.000762798,0.000776804,0.000790776,0.000804782,0.000818788,0.000832794,0.0008468,0.000860805,0.00087481,0.000888816,0.00090282,0.000916825,0.00093083,0.000944834,0.000958839,0.000972843,0.000986847,0.00100085,0.00101486,0.00102886,0.00104286,0.00105687,0.00107087,0.00108487,0.00109888,0.00111288,0.00112688,0.00114089,0.00115489,0.00116889,0.00118289,0.0011969,0.0012109,0.0012249,0.00123891,0.00125291,0.00126691,0.00128091,0.00129492,0.00130892,0.00132292,0.00133692,0.00135092,0.00136493,0.00137893,0.00139293,0.00140693,0.00142093,0.00143494,0.00144894,0.00146294,0.00147694,0.00149094,0.00150494,0.00151895,0.00153295,0.00154695,0.00156095,0.00157495,0.00158895,0.00160296,0.00161696,0.00163096,0.00164496,0.00165896,0.00167296,0.00168696,0.00170097,0.00171497,0.00172897,0.00174297,0.00175697,0.00177097,0.00178497,0.00179897,0.00181297,0.00182698,0.00184098,0.00185498,0.00186898,0.00188298,0.00189698,0.00191098,0.00192498,0.00193898,0.00195298,0.00196699,0.00198099,0.00199499,0.00200899,0.00202299,0.00203699,0.00205099,0.00206499,0.00207899,0.00209299,0.00210699,0.00212099,0.002135,0.002149,0.002163,0.002177,0.002191,0.002205,0.002219,0.002233,0.002247,0.002261,0.002275,0.002289,0.002303,0.002317,0.002331,0.002345,0.00235901,0.00237301,0.00238701,0.00240101,0.00241501,0.00242901,0.00244301,0.00245701,0.00247101,0.00248501,0.00249901,0.00251301,0.00252701,0.00254101,0.00255501,0.00256901,0.00258301,0.00259701,0.00261101,0.00262501,0.00263901,0.00265301,0.00266701,0.00268102,0.00269502,0.00270902,0.00272302,0.00273702,0.00275102,0.00276502,0.00277902,0.00279302,0.00280702,0.00282102,0.00283502,0.00284902,0.00286302,0.00287702,0.00289102,0.00290502,0.00291902,0.00293302,0.00294702,0.00296102,0.00297502,0.00298902,0.00300302,0.00301702,0.00303102,0.00304502,0.00305902,0.00307302,0.00308702,0.00310102,0.00311502,0.00312902,0.00314302,0.00315702,0.00317102,0.00318502,0.00319902,0.00321302,0.00322702,0.00324102,0.00325502,0.00326902,0.00328302,0.00329702,0.00331102,0.00332502,0.00333902,0.00335303,0.00336703,0.00338103,0.00339503,0.00340903,0.00342303,0.00343703,0.00345103,0.00346503,0.00347903,0.00349303,0.00350703,0.00352103,0.00353503,0.00354903,0.00356303,0.00357703,0.00359103,0.00360503,0.00361903,0.00363303,0.00364703,0.00366103,0.00367503,0.00368903,0.00370303,0.00371703,0.00373103,0.00374503,0.00375902,0.00377302,0.00378702,0.00380102,0.00381502,0.00382902,0.00384302,0.00385702,0.00387102,0.00388502,0.00389902,0.00391302,0.00392702,0.00394102,0.00395502,0.00396902,0.00398302,0.00399702,0.00401102,0.00402502,0.00403902,0.00405302,0.00406702,0.00408102,0.00409502,0.00410902,0.00412302,0.00413702,0.00415102,0.00416502,0.00417902,0.00419302,0.00420702,0.00422102,0.00423502,0.00424902,0.00426302,0.00427702,0.00429102,0.00430502,0.00431902,0.00433302,0.00434702,0.00436102,0.00437502,0.00438902,0.00440302,0.00441702,0.00443102,0.00444501,0.00445901,0.00447301,0.00448701,0.00450101,0.00451501,0.00452901,0.00454301,0.00455701,0.00457101,0.00458501,0.00459901,0.00461301,0.00462701,0.00464101,0.00465501,0.00466901,0.00468301,0.00469701,0.00471101,0.00472501,0.00473901,0.004753,0.004767,0.004781,0.004795,0.004809,0.004823,0.004837,0.004851,0.004865,0.004879,0.004893,0.004907,0.004921,0.004935,0.004949,0.004963,0.00497699,0.00499099,0.00500499,0.00501899,0.00503299,0.00504699,0.00506099,0.00507499,0.00508899,0.00510299,0.00511699,0.00513099,0.00514498,0.00515898,0.00517298,0.00518698,0.00520098,0.00521498,0.00522898,0.00524298,0.00525698,0.00527098,0.00528497,0.00529897,0.00531297,0.00532697,0.00534097,0.00535497,0.00536897,0.00538297,0.00539697,0.00541096,0.00542496,0.00543896,0.00545296,0.00546696,0.00548096,0.00549496,0.00550895,0.00552295,0.00553695,0.00555095,0.00556495,0.00557895,0.00559295,0.00560694,0.00562094,0.00563494,0.00564894,0.00566294,0.00567693,0.00569093,0.00570493,0.00571893,0.00573293,0.00574692,0.00576092,0.00577492,0.00578892,0.00580292,0.00581691,0.00583091,0.00584491,0.00585891,0.0058729,0.0058869,0.0059009,0.0059149,0.00592889,0.00594289,0.00595689,0.00597088,0.00598488,0.00599888,0.00601287,0.00602687,0.00604087,0.00605486,0.00606886,0.00608286,0.00609685,0.00611085,0.00612484,0.00613884,0.00615284,0.00616683,0.00618083,0.00619482,0.00620882,0.00622281,0.00623681,0.0062508,0.0062648,0.00627879,0.00629278,0.00630681,0.00632081,0.0063348,0.0063488,0.00636279,0.00637678,0.00639078,0.00640477,0.00641876,0.00643275,0.00644675,0.00646074,0.00647473,0.00648872,0.00650271,0.0065167,0.00653069,0.00654468,0.00655867,0.00657266,0.00658665,0.00660063,0.00661462,0.00662861,0.00664259,0.00665658,0.00667056,0.00668454,0.00669852,0.0067125,0.00672647,0.00674045,0.00675443,0.00676841,0.00678238,0.00679635,0.00681039,0.00682437,0.00683857,0.00685264,0.00686667,0.00688061,0.00689445,0.00690827,0.00692205,0.00693588,0.00694979,0.00696489,0.00698097,0.00699277,0.00700172,0.00701228,0.00702724,0.00705401,0.00708569,0.00712019,0.00715642,0.00719363,0.00723093,0.00726832,0.0073067,0.00734276,0.00737863,0.00741422,0.00744984,0.00748516,0.00752032,0.00755532,0.00759005,0.00762498,0.0076596,0.00769426,0.00772734,0.00776107,0.00779501,0.00782919,0.00786338,0.00789767,0.00793234,0.00796723,0.00800232,0.00803745,0.00807219,0.00810647,0.0081404,0.00817508,0.00821077,0.00824671,0.0082824,0.00831749,0.00835223,0.00838744,0.0084234,0.00845936,0.00849465,0.00852881,0.00856207,0.00859524,0.00862923,0.0086641,0.00869948,0.00873486,0.00876983,0.00880355,0.00883676,0.00887259,0.00891012,0.00894674,0.00898227,0.0090162,0.00904953,0.00908495,0.00912142,0.00915691,0.00919153,0.00922485,0.0092578,0.00929326,0.00933019,0.00936581,0.00939964,0.00943263,0.00946788,0.00950454,0.00953998,0.00957381,0.00960698,0.00964272,0.00968002,0.00971597,0.0097501,0.00978355,0.0098193,0.00985626,0.00989181,0.00992559,0.00995873,0.00999419,0.010031,0.0100665,0.0101002,0.0101333,0.0101688,0.0102056,0.0102412,0.0102749,0.0103078,0.010343,0.0103797,0.0104154,0.0104494,0.010483,0.0105192,0.0105571,0.0105935,0.0106281,0.010662,0.010698,0.0107346,0.0107695,0.0108025,0.0108349,0.0108696,0.010906,0.0109414,0.0109755,0.0110091,0.0110452,0.0110828,0.0111188,0.0111531,0.0111869,0.0112229,0.0112597,0.0112948,0.0113281,0.0113608,0.0113959,0.0114323,0.0114675,0.0115014,0.0115348,0.0115708,0.0116083,0.0116444,0.0116787,0.0117125,0.0117484,0.0117851,0.01182,0.0118531,0.0118857,0.0119207,0.0119572,0.0119927,0.0120268,0.0120604,0.0120966,0.012134,0.01217,0.0122042,0.0122379,0.0122738,0.0123106,0.0123458,0.0123791,0.012412,0.0124472,0.0124836,0.0125188,0.0125525,0.0125859,0.0126219,0.0126593,0.0126954,0.0127296,0.0127635,0.0127998,0.0128369,0.0128725,0.012906,0.0129392,0.0129745,0.013011,0.0130464,0.0130802,0.0131137,0.0131493,0.0131858,0.013221,0.0132546,0.0132879,0.0133235,0.0133605,0.0133967,0.0134321,0.0134663,0.0135005,0.0135372,0.0135743,0.0136094,0.0136435,0.0136769,0.0137091,0.0137404,0.0137736,0.0138092,0.0138456,0.0138802,0.0139152])
# profile at t=+0.002s
d=np.array([508.059,508.07,508.051,508.035,508.028,508.017,508.005,507.991,507.976,507.962,507.952,507.944,507.934,507.921,507.907,507.891,507.875,507.856,507.837,507.817,507.795,507.773,507.749,507.725,507.698,507.671,507.642,507.612,507.581,507.549,507.515,507.481,507.445,507.408,507.37,507.33,507.29,507.248,507.205,507.161,507.116,507.07,507.023,506.974,506.924,506.873,506.821,506.768,506.714,506.658,506.602,506.544,506.485,506.425,506.364,506.301,506.238,506.174,506.108,506.041,505.973,505.904,505.834,505.762,505.69,505.616,505.541,505.466,505.389,505.311,505.231,505.151,505.07,504.987,504.903,504.819,504.733,504.646,504.558,504.469,504.378,504.287,504.195,504.101,504.006,503.911,503.814,503.716,503.617,503.517,503.416,503.314,503.21,503.106,503.001,502.894,502.787,502.678,502.568,502.458,502.346,502.233,502.119,502.004,501.888,501.771,501.653,501.534,501.414,501.293,501.171,501.047,500.923,500.798,500.671,500.544,500.416,500.286,500.156,500.024,499.892,499.759,499.624,499.489,499.352,499.215,499.077,498.937,498.797,498.655,498.513,498.37,498.225,498.08,497.934,497.787,497.639,497.489,497.339,497.188,497.036,496.883,496.729,496.575,496.419,496.262,496.104,495.946,495.786,495.626,495.465,495.302,495.139,494.975,494.81,494.644,494.477,494.309,494.141,493.971,493.801,493.63,493.457,493.284,493.11,492.936,492.76,492.583,492.406,492.228,492.048,491.868,491.688,491.506,491.323,491.14,490.956,490.771,490.585,490.398,490.211,490.022,489.833,489.643,489.452,489.261,489.068,488.875,488.681,488.486,488.291,488.094,487.897,487.699,487.501,487.301,487.101,486.9,486.698,486.496,486.293,486.089,485.884,485.678,485.472,485.265,485.058,484.849,484.64,484.43,484.22,484.009,483.797,483.584,483.371,483.157,482.942,482.726,482.51,482.294,482.076,481.858,481.639,481.42,481.2,480.979,480.757,480.535,480.313,480.089,479.865,479.641,479.416,479.19,478.963,478.736,478.508,478.28,478.051,477.822,477.592,477.361,477.13,476.898,476.665,476.432,476.199,475.965,475.73,475.495,475.259,475.022,474.786,474.548,474.31,474.072,473.833,473.593,473.353,473.112,472.871,472.629,472.387,472.145,471.902,471.658,471.414,471.169,470.924,470.679,470.433,470.186,469.939,469.692,469.444,469.196,468.947,468.698,468.448,468.198,467.947,467.696,467.445,467.193,466.941,466.689,466.436,466.182,465.928,465.674,465.42,465.165,464.909,464.654,464.398,464.141,463.884,463.627,463.37,463.112,462.854,462.595,462.336,462.077,461.817,461.558,461.297,461.037,460.776,460.515,460.253,459.992,459.73,459.467,459.205,458.942,458.679,458.415,458.152,457.888,457.623,457.359,457.094,456.829,456.564,456.298,456.033,455.767,455.5,455.234,454.967,454.7,454.433,454.166,453.898,453.631,453.363,453.095,452.827,452.558,452.289,452.021,451.752,451.482,451.213,450.944,450.674,450.404,450.134,449.864,449.594,449.323,449.053,448.782,448.512,448.241,447.97,447.699,447.427,447.156,446.884,446.613,446.341,446.07,445.798,445.526,445.254,444.982,444.71,444.438,444.165,443.893,443.621,443.348,443.076,442.803,442.531,442.258,441.985,441.713,441.44,441.167,440.895,440.622,440.349,440.076,439.804,439.531,439.258,438.985,438.713,438.44,438.167,437.895,437.622,437.349,437.077,436.804,436.532,436.259,435.987,435.714,435.442,435.17,434.898,434.625,434.353,434.081,433.809,433.538,433.266,432.994,432.723,432.451,432.18,431.908,431.637,431.366,431.095,430.824,430.553,430.283,430.012,429.742,429.472,429.202,428.932,428.662,428.392,428.122,427.853,427.584,427.315,427.046,426.777,426.508,426.24,425.972,425.703,425.436,425.168,424.9,424.633,424.366,424.099,423.832,423.565,423.299,423.033,422.767,422.501,422.235,421.969,421.704,421.439,421.175,420.91,420.646,420.382,420.118,419.855,419.591,419.328,419.066,418.803,418.541,418.279,418.017,417.756,417.494,417.234,416.973,416.712,416.452,416.193,415.933,415.674,415.415,415.156,414.898,414.64,414.382,414.125,413.868,413.611,413.355,413.099,412.842,412.586,412.327,412.07,411.815,411.562,411.311,411.06,410.811,410.56,410.306,410.024,409.75,409.527,409.358,409.159,408.932,408.457,407.885,407.265,406.619,405.96,405.304,404.65,403.981,403.361,402.745,402.138,401.532,400.934,400.341,399.753,399.171,398.587,398.011,397.437,396.884,396.326,395.768,395.209,394.652,394.096,393.537,392.976,392.416,391.86,391.313,390.776,390.244,389.702,389.149,388.597,388.055,387.525,387.002,386.473,385.938,385.409,384.895,384.401,383.921,383.441,382.951,382.451,381.949,381.451,380.964,380.497,380.033,379.535,379.025,378.534,378.061,377.614,377.17,376.702,376.23,375.775,375.334,374.912,374.491,374.042,373.583,373.146,372.734,372.329,371.899,371.461,371.042,370.645,370.253,369.835,369.407,369.001,368.618,368.24,367.84,367.436,367.051,366.688,366.33,365.95,365.564,365.196,364.848,364.506,364.143,363.773,363.422,363.09,362.766,362.422,362.07,361.733,361.414,361.099,360.762,360.418,360.093,359.789,359.488,359.173,358.86,358.566,358.289,358.017,357.727,357.43,357.145,356.873,356.606,356.323,356.034,355.762,355.507,355.255,354.99,354.727,354.479,354.247,354.018,353.775,353.529,353.295,353.073,352.854,352.622,352.386,352.164,351.955,351.751,351.537,351.324,351.125,350.939,350.756,350.563,350.366,350.179,350.002,349.828,349.645,349.461,349.288,349.127,348.969,348.804,348.641,348.489,348.347,348.208,348.062,347.916,347.778,347.649,347.522,347.389,347.256,347.131,347.016,346.903,346.786,346.671,346.565,346.468,346.373,346.275,346.179,346.089,346.005,345.925,345.842,345.762,345.688,345.621,345.555,345.489,345.424,345.364,345.309,345.259,345.21,345.162,345.119,345.08,345.046,345.016,344.989,344.965,344.941,344.919,344.901,344.901,344.89])
# profile at t=+0.010s
d1=np.array([416.24,416.251,416.232,416.218,416.214,416.205,416.196,416.186,416.176,416.168,416.165,416.164,416.162,416.158,416.153,416.147,416.141,416.134,416.127,416.119,416.111,416.103,416.094,416.085,416.075,416.064,416.054,416.042,416.03,416.018,416.005,415.992,415.978,415.964,415.949,415.934,415.918,415.902,415.885,415.868,415.851,415.833,415.815,415.796,415.776,415.757,415.736,415.716,415.695,415.673,415.651,415.629,415.606,415.582,415.559,415.534,415.51,415.485,415.459,415.433,415.407,415.38,415.353,415.325,415.297,415.268,415.239,415.209,415.179,415.149,415.118,415.087,415.055,415.023,414.99,414.957,414.924,414.89,414.856,414.821,414.786,414.75,414.714,414.678,414.641,414.603,414.566,414.527,414.489,414.45,414.41,414.371,414.33,414.29,414.248,414.207,414.165,414.122,414.08,414.036,413.993,413.949,413.904,413.859,413.814,413.768,413.722,413.676,413.629,413.581,413.533,413.485,413.437,413.388,413.338,413.289,413.238,413.188,413.137,413.085,413.033,412.981,412.929,412.876,412.822,412.768,412.714,412.66,412.605,412.549,412.493,412.437,412.381,412.324,412.266,412.209,412.151,412.092,412.033,411.974,411.914,411.854,411.794,411.733,411.672,411.611,411.549,411.486,411.424,411.361,411.297,411.234,411.17,411.105,411.04,410.975,410.909,410.843,410.777,410.71,410.643,410.576,410.508,410.44,410.372,410.303,410.234,410.164,410.094,410.024,409.953,409.882,409.811,409.74,409.668,409.595,409.523,409.45,409.376,409.303,409.229,409.154,409.08,409.005,408.929,408.854,408.778,408.701,408.625,408.548,408.47,408.393,408.315,408.236,408.158,408.079,408,407.92,407.84,407.76,407.68,407.599,407.518,407.436,407.354,407.272,407.19,407.107,407.025,406.941,406.858,406.774,406.69,406.605,406.521,406.436,406.35,406.265,406.179,406.093,406.006,405.919,405.832,405.745,405.658,405.57,405.482,405.393,405.304,405.215,405.126,405.037,404.947,404.857,404.767,404.676,404.585,404.494,404.403,404.311,404.219,404.127,404.035,403.942,403.849,403.756,403.663,403.569,403.475,403.381,403.287,403.192,403.097,403.002,402.907,402.811,402.715,402.619,402.523,402.426,402.33,402.233,402.136,402.038,401.941,401.843,401.745,401.646,401.548,401.449,401.35,401.251,401.152,401.052,400.952,400.852,400.752,400.652,400.551,400.45,400.349,400.248,400.147,400.045,399.943,399.841,399.739,399.637,399.534,399.432,399.329,399.226,399.122,399.019,398.915,398.811,398.707,398.603,398.499,398.394,398.29,398.185,398.08,397.975,397.869,397.764,397.658,397.552,397.446,397.34,397.234,397.128,397.021,396.914,396.807,396.7,396.593,396.486,396.378,396.271,396.163,396.055,395.947,395.839,395.731,395.622,395.514,395.405,395.296,395.187,395.078,394.969,394.86,394.75,394.641,394.531,394.421,394.312,394.202,394.091,393.981,393.871,393.761,393.65,393.539,393.429,393.318,393.207,393.096,392.985,392.873,392.762,392.651,392.539,392.428,392.316,392.204,392.092,391.98,391.868,391.756,391.644,391.532,391.42,391.307,391.195,391.082,390.97,390.857,390.744,390.631,390.519,390.406,390.293,390.18,390.067,389.953,389.84,389.727,389.614,389.5,389.387,389.273,389.16,389.046,388.933,388.819,388.705,388.592,388.478,388.364,388.25,388.136,388.022,387.908,387.795,387.681,387.567,387.452,387.338,387.224,387.11,386.996,386.882,386.768,386.654,386.539,386.425,386.311,386.197,386.083,385.968,385.854,385.74,385.626,385.511,385.397,385.283,385.169,385.054,384.94,384.826,384.712,384.597,384.483,384.369,384.255,384.141,384.027,383.912,383.798,383.684,383.57,383.456,383.342,383.228,383.114,383,382.886,382.772,382.658,382.545,382.431,382.317,382.203,382.09,381.976,381.862,381.749,381.635,381.522,381.408,381.295,381.181,381.068,380.955,380.842,380.729,380.615,380.502,380.389,380.277,380.164,380.051,379.938,379.826,379.713,379.6,379.488,379.376,379.263,379.151,379.039,378.927,378.815,378.703,378.591,378.479,378.367,378.256,378.144,378.033,377.921,377.81,377.699,377.588,377.477,377.365,377.254,377.142,377.031,376.92,376.81,376.701,376.593,376.484,376.375,376.262,376.134,376.021,375.911,375.829,375.733,375.648,375.443,375.189,374.914,374.629,374.339,374.051,373.763,373.47,373.199,372.93,372.665,372.399,372.137,371.877,371.618,371.362,371.103,370.848,370.594,370.345,370.095,369.844,369.593,369.343,369.093,368.841,368.588,368.335,368.085,367.839,367.596,367.354,367.107,366.855,366.604,366.359,366.119,365.881,365.639,365.395,365.155,364.923,364.7,364.482,364.261,364.035,363.804,363.573,363.343,363.12,362.905,362.688,362.454,362.219,361.992,361.776,361.57,361.362,361.143,360.925,360.715,360.512,360.316,360.117,359.905,359.691,359.488,359.296,359.105,358.901,358.696,358.5,358.314,358.127,357.927,357.726,357.536,357.356,357.176,356.985,356.795,356.614,356.443,356.272,356.089,355.906,355.732,355.567,355.402,355.227,355.051,354.884,354.726,354.57,354.403,354.234,354.073,353.92,353.767,353.604,353.439,353.284,353.139,352.993,352.841,352.691,352.55,352.418,352.285,352.144,352,351.862,351.731,351.6,351.461,351.322,351.191,351.068,350.945,350.815,350.688,350.569,350.457,350.344,350.225,350.106,349.992,349.884,349.777,349.662,349.548,349.44,349.339,349.239,349.134,349.031,348.934,348.844,348.754,348.658,348.562,348.47,348.384,348.298,348.208,348.118,348.034,347.956,347.878,347.796,347.717,347.643,347.574,347.505,347.433,347.361,347.293,347.23,347.167,347.101,347.035,346.974,346.917,346.861,346.803,346.746,346.694,346.647,346.599,346.55,346.503,346.458,346.417,346.376,346.335,346.295,346.259,346.225,346.192,346.158,346.126,346.096,346.068,346.043,346.018,345.993,345.972,345.952,345.935,345.92,345.906,345.893,345.881,345.869,345.859,345.863,345.857])
guess = [400,1000,0.005]
curve_fit(gaussian_1D_fitting,c,d,guess)
curve_fit(gaussian_1D_fitting,c,d1,guess)
